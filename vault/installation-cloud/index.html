<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=https://staging.doc.kerberos.live/main.1dbae5baf528956da9069d0b0a13aa65a571f42e537cc8fbbb9f688c33df4ce054481dda3f0abef218ddcad241ec35f9c1560985dd831a64a6c73c3d039f39a1.css integrity="sha512-HbrluvUolW2pBp0LChOqZaVx9C5TfMj7u59ojDPfTOBUSB3aPwq+8hjdytJB7DX5wVYJhd2DGmSmxzw9A585oQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Cloud Installation - Kerberos Docs</title><meta name=description content="Open and extensible video surveillance and analytics solution for everyone at any location."><link rel=canonical href=https://staging.doc.kerberos.live/vault/installation-cloud/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="/doks.png"><meta name=twitter:title content="Cloud Installation"><meta name=twitter:description content="If not already the case, start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (AWS, GCP or Azure), cloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.
  Prerequisites Kerberos Vault is the storage component for Kerberos Enterprise. It is used to store your recordings at a central place, in the storage system you prefer. Next to that it can be used for extension and integration capabilities."><meta name=twitter:site content="@kerberosio"><meta name=twitter:creator content="@kerberosio"><meta property="og:title" content="Cloud Installation"><meta property="og:description" content="If not already the case, start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (AWS, GCP or Azure), cloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.
  Prerequisites Kerberos Vault is the storage component for Kerberos Enterprise. It is used to store your recordings at a central place, in the storage system you prefer. Next to that it can be used for extension and integration capabilities."><meta property="og:type" content="article"><meta property="og:url" content="/vault/installation-cloud/"><meta property="og:image" content="/doks.png"><meta property="article:published_time" content="2020-10-06T08:49:31+00:00"><meta property="article:modified_time" content="2020-10-06T08:49:31+00:00"><meta property="og:site_name" content="Kerberos Docs"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/staging.doc.kerberos.live\/"},{"@type":"ListItem","position":3,"name":"Vault","item":"https:\/\/staging.doc.kerberos.live\/\/vault\/"},{"@type":"ListItem","position":4,"name":"Installation Cloud","item":"https:\/\/staging.doc.kerberos.live\/\/vault\/installation-cloud\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://staging.doc.kerberos.live/favicons/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://staging.doc.kerberos.live/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://staging.doc.kerberos.live/favicons/favicon-16x16.png><link rel=manifest href=https://staging.doc.kerberos.live/site.webmanifest></head><body class="vault single"><div class="header-bar fixed-top"></div><header class="navbar fixed-top navbar-expand-md navbar-light"><div class=container><input class="menu-btn order-0" type=checkbox id=menu-btn>
<label class="menu-icon d-md-none" for=menu-btn><span class=navicon></span></label><a class="navbar-brand order-1 order-md-0 me-auto" href=https://staging.doc.kerberos.live/><img src=https://staging.doc.kerberos.live/images/kerberos-logo.svg class=logo>
Kerberos Docs</a>
<button id=mode class="btn btn-link order-2 order-md-4" type=button aria-label="Toggle mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button><div class="collapse navbar-collapse order-4 order-md-1"><ul class="navbar-nav main-nav me-auto order-5 order-md-2"><li class=nav-item><a class=nav-link href=https://kerberos.io>Homepage</a></li></ul><div class="break order-6 d-md-none"></div><form class="navbar-form flex-grow-1 order-7 order-md-3"><input id=userinput class="form-control is-search" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=suggestions class="shadow bg-white rounded"></div></form></div></div></header><div class="wrap container" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar"><nav class=docs-links aria-label="Main navigation"><h3>Prologue</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/>Introduction</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/prologue/how/>How it works</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/prologue/deployments/>Deployments</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/prologue/glossary/>Glossary</a></li></ul><h3>Opensource v2</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/first-things-first/>First things first</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/get-started/>Get started</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/installation/>Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/installation-advanced/>Advanced Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/releases/>Release notes</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/license/>License</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/upgrade/>Upgrade</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/contribute/>Contribute</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/machinery/>Machinery</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/opensource/web/>Web</a></li></ul><h3>Opensource v3</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/opensourcev3/announcement/>Announcement</a></li></ul><h3>Enterprise</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/first-things-first/>First things first</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/get-started/>Get Started</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/installation/>Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/installation-cloud/>Cloud Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/installation-edge/>Edge Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/enterprise/releases/>Releases</a></li></ul><h3>Vault</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/first-things-first/>First things first</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/get-started/>Get Started</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/installation/>Installation</a></li><li><a class="docs-link active" href=https://staging.doc.kerberos.live/vault/installation-cloud/>Cloud Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/installation-edge/>Edge Installation</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/providers/>Providers</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/recycle/>Recycle</a></li><li><a class=docs-link href=https://staging.doc.kerberos.live/vault/releases/releases/>Releases</a></li></ul><h3>Hub</h3><ul class=list-unstyled><li><a class=docs-link href=https://staging.doc.kerberos.live/hub/first-things-first/>First things first</a></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-4" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#installation>Installation</a><ul><li><a href=#storage>Storage</a></li></ul></li><li><a href=#test-out-configuration>Test out configuration</a></li><li><a href=#access-the-system>Access the system</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-8"><h1>Cloud Installation</h1><p class=lead></p><p>If not already the case, start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (<strong>AWS</strong>, <strong>GCP</strong> or <strong>Azure</strong>), cloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.</p><div class="responsive-video ratio-16by10"><iframe src=https://player.vimeo.com/video/404813147 title="Running a Kubernetes cluster in the cloud?" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div><h2 id=prerequisites>Prerequisites<a href=#prerequisites class=anchor aria-hidden=true>#</a></h2><p>Kerberos Vault is the storage component for Kerberos Enterprise. It is used to store your recordings at a central place, in the storage system you prefer. Next to that it can be used for extension and integration capabilities. Learn more about <a href=https://staging.doc.kerberos.live/storage>Kerberos Vault here</a>.</p><p>To use Kerberos Vault, you will need to have Kerberos Enterprise installed, and deployments running. Independent from that one can also use the Kerberos Vault API <code>/swagger/index.html</code> to send recordings from a custom build VMS.</p><h2 id=installation>Installation<a href=#installation class=anchor aria-hidden=true>#</a></h2><p>Similar to Kerberos Enterprise, Kerberos Vault, requires some initial components to be installed. If you will run Kerberos Vault in the same cluster as where you have Kerberos Enterprise running, there is not much to do.</p><figure class=stretch><img src=../first-things-first/arch-kerberos-vault-providers.svg alt="Bring your own storage using Kerberos Vault"><figcaption><p>Bring your own storage using Kerberos Vault</p></figcaption></figure><p>However if you plan to run Kerberos Vault in a different cluster (which is perfectly possible), you will need to make sure you complete the initial setup of <a href=https://staging.doc.kerberos.live/enterprise/installation>Kerberos Enterprise installation</a>. To be more specific you will need the following components running:</p><ul><li>Helm</li><li>MongoDB</li><li>Traefik</li></ul><p>Once this is done start by cloning the configurations from our <a href=https://github.com/kerberos-io/storage>Github repo</a>.</p><pre><code>git clone https://github.com/kerberos-io/storage
</code></pre><h3 id=storage>Storage<a href=#storage class=anchor aria-hidden=true>#</a></h3><p>Similar to Kerberos Enterprise, Kerberos Vault is managed through a web app. It allows you to add storage providers (S3, minio, etc), add queues for messaging, accounts for security and much more. It also comes with API&rsquo;s, which you can use to interact and retrieve information from Kerberos Vault. All is documented in the form of Swagger APIs <code>/swagger/index.html</code>.</p><p>Before installing Kerberos Vault, open the <code>./storage/yaml/deployment.yaml</code> configuration file. At the bottom file you will find two endpoints, similar to the Traefik config file below. Update the domain names to your own domain, and add these to your DNS server or <code>/etc/hosts</code> file (and point to the same IP as the Traefik EXTERNAL-IP).</p><pre><code>    spec:
      rules:
--&gt;   - host: storage.domain.com
        http:
          paths:
          - path: /
            backend:
              serviceName: kerberos-storage
              servicePort: 80
--&gt;   - host: api.storage.domain.com
        http:
          paths:
          - path: /
            backend:
              serviceName: kerberos-storage
              servicePort: 8081
</code></pre><p>If you are using Ingress Nginx, do not forgot to comment <code>Traefik</code> and uncomment <code>Ingress Nginx</code>. Also note the extra argument <code>proxy-body-size</code>, this is required for not reaching the default 1MB body size limit. If you do not enable this, you might experience <code>413</code> errors in your Kerberos Enterprise agents.</p><pre><code>apiVersion: extensions/v1beta1
kind: Ingress
metadata:
  name: kerberos-storage
  annotations:
    #kubernetes.io/ingress.class: traefik
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/proxy-body-size: 200m
</code></pre><p>Next to that modify the MongoDB credentials, and make sure they match the credentials of your MongoDB instance.</p><pre><code>    - name: MONGODB_USERNAME
      value: &quot;root&quot;
    - name: MONGODB_PASSWORD
--&gt;   value: &quot;xxxxxxxxxx&quot;
</code></pre><p>Once you have corrected the DNS names and MongoDB credentials, install Kerberos Vault inside your cluster.</p><pre><code>kubectl apply -f ./storage/yaml/deployment.yaml
</code></pre><h2 id=test-out-configuration>Test out configuration<a href=#test-out-configuration class=anchor aria-hidden=true>#</a></h2><p>If everything worked out as expected, you should now have following services in your cluster:</p><ul><li>MongoDB</li><li>Traefik</li><li>Storage</li><li>Enterprise (optional)</li></ul><p>It should look like this.</p><pre><code>$ kubectl get pods
NAME                              READY   STATUS    RESTARTS   AGE
kerberos-storage-6f5c877d7c-hf77p 1/1     Running   0          2d11h
mongodb-55566dc65c-xgmns          2/2     Running   0          4d13h
traefik-7d566ccc47-mwslb          1/1     Running   0          4d12h
</code></pre><h2 id=access-the-system>Access the system<a href=#access-the-system class=anchor aria-hidden=true>#</a></h2><p>Once everything is configured correctly your cluster and DNS or <code>/etc/hosts</code> file, you should be able to access the Storage application. By navigating to the Storage domain <code>storage.domain.com</code> in your browser you will see the Storage login page showing up.</p><figure class=stretch><img src=login.png alt="Once successfully installed Kerberos Vault, it will show you the login page."><figcaption><p>Once successfully installed Kerberos Vault, it will show you the login page.</p></figcaption></figure><p class=edit-page><a href=https://github.com/kerberos-io/documentation/blob/master/content/vault/installation-cloud/index.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></p><div class="docs-navigation d-flex justify-content-between"><a href=https://staging.doc.kerberos.live/vault/installation/><div class="card my-1"><div class="card-body py-2">&larr; Installation</div></div></a><a class=ms-auto href=https://staging.doc.kerberos.live/vault/installation-edge/><div class="card my-1"><div class="card-body py-2">Edge Installation &rarr;</div></div></a></div></main></div></div></div><footer class="footer text-muted"><div class=container><div class=row><div class="col-lg-6 order-last order-lg-first"><ul class="navbar-nav social-nav"><li class=copyright>&copy;&nbsp;2014&ndash;2021
<a href=https://kerberos.io>Kerberos.io</a></li><li class=nav-item><a class=link href=https://twitter.com/kerberosio title=Twitter><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><span class="ms-2 visually-hidden">Twitter</span></a></li><li class=nav-item><a class=link href=https://github.com/kerberos-io title=GitHub><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><span class="ms-2 visually-hidden">GitHub</span></a></li><li class=nav-item><a class=link href=https://www.reddit.com/r/kerberos_io/ title=Reddit><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-message-circle"><path d="M21 11.5a8.38 8.38.0 01-.9 3.8A8.5 8.5.0 0112.5 20a8.38 8.38.0 01-3.8-.9L3 21l1.9-5.7A8.38 8.38.0 014 11.5a8.5 8.5.0 014.7-7.6 8.38 8.38.0 013.8-.9h.5a8.48 8.48.0 018 8v.5z"/></svg><span class="ms-2 visually-hidden">Reddit</span></a></li></ul></div><div class="col-lg-10 order-first order-lg-last text-lg-end"><ul class=list-inline><li class=list-inline-item>Learn more about</li><li class=list-inline-item><a href=https://kerberos.io/product/enterprise-agent/>Enterprise Agent</a></li><li class=list-inline-item><a href=https://kerberos.io/product/hub/>Hub</a></li><li class=list-inline-item><a href=https://kerberos.io/product/open-source/>Kerberos Opensource</a></li><li class=list-inline-item><a href=https://kerberos.io/product/vault/>Vault</a></li></ul></div></div></div></footer><script src=https://staging.doc.kerberos.live/js/highlight.min.8cdbefd08ec63ef25f4b2510ae50c13b3d9ed43e25a15ddb55f14c33130e68cf8be3131ccf2d087c49f5f21fe88c2f0e2715a21f936047d0d0b85dc48cb864b9.js integrity="sha512-jNvv0I7GPvJfSyUQrlDBOz2e1D4loV3bVfFMMxMOaM+L4xMczy0IfEn18h/ojC8OJxWiH5NgR9DQuF3EjLhkuQ==" crossorigin=anonymous defer></script><script src=https://staging.doc.kerberos.live/main.min.89223fc6eee34e2dc10266cff3c7fc87949c595388f775ec6e93132410cef77e5ff7f24a81db03c9b9eb6d2e6d75ea5a7d22945c574b65dfeb426f65af771230.js integrity="sha512-iSI/xu7jTi3BAmbP88f8h5ScWVOI93XsbpMTJBDO935f9/JKgdsDybnrbS5tdepafSKUXFdLZd/rQm9lr3cSMA==" crossorigin=anonymous defer></script><script src=https://staging.doc.kerberos.live/index.min.043f7b7308409ac3e67679315a41fd9fac3fd39f80a7f5ac82dd92857185f29b11e21997d5723c9fc448098a72292664dc3016ded635b4475220cdbd4bdda613.js integrity="sha512-BD97cwhAmsPmdnkxWkH9n6w/05+Ap/Wsgt2ShXGF8psR4hmX1XI8n8RICYpyKSZk3DAW3tY1tEdSIM29S92mEw==" crossorigin=anonymous defer></script></body></html>