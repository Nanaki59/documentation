{"expireTime":9007200840575935000,"key":"gatsby-plugin-mdx-entire-payload-88b928e26acd361f6246d7d7063bd6f1-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/i353408/Vagrant/www/repos/documentation/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":125,"offset":126},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":128},"end":{"line":5,"column":29,"offset":156},"indent":[]}},{"type":"import","value":"import ReplaceVersion from \"../components/ReplaceVersion\";","position":{"start":{"line":8,"column":1,"offset":159},"end":{"line":8,"column":59,"offset":217},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Introduction","position":{"start":{"line":10,"column":3,"offset":221},"end":{"line":10,"column":15,"offset":233},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":219},"end":{"line":10,"column":15,"offset":233},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (","position":{"start":{"line":12,"column":1,"offset":235},"end":{"line":12,"column":88,"offset":322},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"AWS","position":{"start":{"line":12,"column":90,"offset":324},"end":{"line":12,"column":93,"offset":327},"indent":[]}}],"position":{"start":{"line":12,"column":88,"offset":322},"end":{"line":12,"column":95,"offset":329},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":12,"column":95,"offset":329},"end":{"line":12,"column":97,"offset":331},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"GCP","position":{"start":{"line":12,"column":99,"offset":333},"end":{"line":12,"column":102,"offset":336},"indent":[]}}],"position":{"start":{"line":12,"column":97,"offset":331},"end":{"line":12,"column":104,"offset":338},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":12,"column":104,"offset":338},"end":{"line":12,"column":108,"offset":342},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Azure","position":{"start":{"line":12,"column":110,"offset":344},"end":{"line":12,"column":115,"offset":349},"indent":[]}}],"position":{"start":{"line":12,"column":108,"offset":342},"end":{"line":12,"column":117,"offset":351},"indent":[]}},{"type":"text","value":"),\ncloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.","position":{"start":{"line":12,"column":117,"offset":351},"end":{"line":13,"column":90,"offset":443},"indent":[1]}}],"position":{"start":{"line":12,"column":1,"offset":235},"end":{"line":13,"column":90,"offset":443},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"TODO write tutorial or create link to tutorial.","position":{"start":{"line":15,"column":1,"offset":445},"end":{"line":15,"column":52,"offset":496},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Installation","position":{"start":{"line":17,"column":3,"offset":500},"end":{"line":17,"column":15,"offset":512},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":498},"end":{"line":17,"column":15,"offset":512},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before setting up Kerberos Enterprise, some configuration needs to happen. First thing that we need to do is setting up the RBAC permissions (Role Based Access Control). We need to enable this to be able to query specific endpoints from the Kubernetes API. By default these endpoints are locked, so we need to unlock them.","position":{"start":{"line":19,"column":1,"offset":514},"end":{"line":19,"column":323,"offset":836},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":514},"end":{"line":19,"column":323,"offset":836},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"First clone the configrations from our Github repo.","position":{"start":{"line":21,"column":1,"offset":838},"end":{"line":21,"column":52,"offset":889},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":838},"end":{"line":21,"column":52,"offset":889},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"git clone https://github.com/kerberos-io/enterprise-factory\ncd enterprise-factory","position":{"start":{"line":23,"column":1,"offset":891},"end":{"line":24,"column":26,"offset":980},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Next go into the directory and execute the first Kubernetes configuration file ","position":{"start":{"line":26,"column":1,"offset":982},"end":{"line":26,"column":80,"offset":1061},"indent":[]}},{"type":"inlineCode","value":"clusterrole.yaml","position":{"start":{"line":26,"column":80,"offset":1061},"end":{"line":26,"column":98,"offset":1079},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":26,"column":98,"offset":1079},"end":{"line":26,"column":99,"offset":1080},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":982},"end":{"line":26,"column":99,"offset":1080},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"kubectl create -f ./clusterrole.yaml","position":{"start":{"line":28,"column":1,"offset":1082},"end":{"line":28,"column":41,"offset":1122},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This will make several actions inside your cluster available. We need this to be able to create deployments from the factory web app.","position":{"start":{"line":30,"column":1,"offset":1124},"end":{"line":30,"column":134,"offset":1257},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":1124},"end":{"line":30,"column":134,"offset":1257},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Helm","position":{"start":{"line":32,"column":4,"offset":1262},"end":{"line":32,"column":8,"offset":1266},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":1259},"end":{"line":32,"column":8,"offset":1266},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Next we will install a couple of dependencies which are required for Kerberos Enterprise. ","position":{"start":{"line":34,"column":1,"offset":1268},"end":{"line":34,"column":91,"offset":1358},"indent":[]}},{"type":"link","title":null,"url":"https://helm.sh/","children":[{"type":"strong","children":[{"type":"text","value":"Helm","position":{"start":{"line":34,"column":94,"offset":1361},"end":{"line":34,"column":98,"offset":1365},"indent":[]}}],"position":{"start":{"line":34,"column":92,"offset":1359},"end":{"line":34,"column":100,"offset":1367},"indent":[]}}],"position":{"start":{"line":34,"column":91,"offset":1358},"end":{"line":34,"column":119,"offset":1386},"indent":[]}},{"type":"text","value":" is a package manager for Kubernetes, it helps you setting up services more easily (this could be a MQTT broker, a database, etc).\nInstead of writing yaml files for every service we need, we use so called ","position":{"start":{"line":34,"column":119,"offset":1386},"end":{"line":35,"column":75,"offset":1591},"indent":[1]}},{"type":"strong","children":[{"type":"text","value":"Charts","position":{"start":{"line":35,"column":77,"offset":1593},"end":{"line":35,"column":83,"offset":1599},"indent":[]}}],"position":{"start":{"line":35,"column":75,"offset":1591},"end":{"line":35,"column":85,"offset":1601},"indent":[]}},{"type":"text","value":" (libraries), that you can reuse and configure the,\nwith the appropriate settings.","position":{"start":{"line":35,"column":85,"offset":1601},"end":{"line":36,"column":31,"offset":1683},"indent":[1]}}],"position":{"start":{"line":34,"column":1,"offset":1268},"end":{"line":36,"column":31,"offset":1683},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Use one of the preferred OS package managers to install the Helm client:","position":{"start":{"line":38,"column":1,"offset":1685},"end":{"line":38,"column":73,"offset":1757},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1685},"end":{"line":38,"column":73,"offset":1757},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"brew install helm\n\nchoco install kubernetes-helm\n\nscoop install helm\n\ngofish install helm","position":{"start":{"line":40,"column":1,"offset":1759},"end":{"line":46,"column":24,"offset":1864},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Initiate helm","position":{"start":{"line":48,"column":5,"offset":1870},"end":{"line":48,"column":18,"offset":1883},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":1866},"end":{"line":48,"column":18,"offset":1883},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you've installed the Helm client, we need to use it to initiate Helm (also called the Tiller service) inside your cluster.\nTiller is what they call the server component of Helm.","position":{"start":{"line":50,"column":1,"offset":1885},"end":{"line":51,"column":55,"offset":2067},"indent":[1]}}],"position":{"start":{"line":50,"column":1,"offset":1885},"end":{"line":51,"column":55,"offset":2067},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"kubectl create serviceaccount tiller --namespace kube-system\nkubectl create -f ./tiller-clusterrolebinding.yaml\n\nhelm init --service-account tiller","position":{"start":{"line":53,"column":1,"offset":2069},"end":{"line":56,"column":39,"offset":2228},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Now you have installed ","position":{"start":{"line":58,"column":1,"offset":2230},"end":{"line":58,"column":24,"offset":2253},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Helm","position":{"start":{"line":58,"column":26,"offset":2255},"end":{"line":58,"column":30,"offset":2259},"indent":[]}}],"position":{"start":{"line":58,"column":24,"offset":2253},"end":{"line":58,"column":32,"offset":2261},"indent":[]}},{"type":"text","value":" inside your cluster we can move on by installing the dependencies.","position":{"start":{"line":58,"column":32,"offset":2261},"end":{"line":58,"column":99,"offset":2328},"indent":[]}}],"position":{"start":{"line":58,"column":1,"offset":2230},"end":{"line":58,"column":99,"offset":2328},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Traefik","position":{"start":{"line":60,"column":4,"offset":2333},"end":{"line":60,"column":11,"offset":2340},"indent":[]}}],"position":{"start":{"line":60,"column":1,"offset":2330},"end":{"line":60,"column":11,"offset":2340},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://containo.us/traefik/","children":[{"type":"strong","children":[{"type":"text","value":"Traefik","position":{"start":{"line":62,"column":4,"offset":2345},"end":{"line":62,"column":11,"offset":2352},"indent":[]}}],"position":{"start":{"line":62,"column":2,"offset":2343},"end":{"line":62,"column":13,"offset":2354},"indent":[]}}],"position":{"start":{"line":62,"column":1,"offset":2342},"end":{"line":62,"column":44,"offset":2385},"indent":[]}},{"type":"text","value":" is a reverse proxy and load balancer which allows you to\nexpose your deployments more easily. Kerberos uses Traefik to expose it's APIs more easily.","position":{"start":{"line":62,"column":44,"offset":2385},"end":{"line":63,"column":92,"offset":2534},"indent":[1]}}],"position":{"start":{"line":62,"column":1,"offset":2342},"end":{"line":63,"column":92,"offset":2534},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"By executing following helm command, we will install traefik and link it to a specific DNS name. Open the traefik values file, and update the DNS name to your own domain.","position":{"start":{"line":65,"column":1,"offset":2536},"end":{"line":65,"column":171,"offset":2706},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":2536},"end":{"line":65,"column":171,"offset":2706},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"    dashboard:\n      enabled: true\n-->   domain: traefik.domain.com\n      serviceType: NodePort\n    rbac:\n        enabled: true","position":{"start":{"line":67,"column":1,"offset":2708},"end":{"line":72,"column":26,"offset":2859},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Execute the ","position":{"start":{"line":74,"column":1,"offset":2861},"end":{"line":74,"column":13,"offset":2873},"indent":[]}},{"type":"inlineCode","value":"helm install","position":{"start":{"line":74,"column":13,"offset":2873},"end":{"line":74,"column":27,"offset":2887},"indent":[]}},{"type":"text","value":" command.","position":{"start":{"line":74,"column":27,"offset":2887},"end":{"line":74,"column":36,"offset":2896},"indent":[]}}],"position":{"start":{"line":74,"column":1,"offset":2861},"end":{"line":74,"column":36,"offset":2896},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"helm install --name traefik -f ./traefik/values.yaml stable/traefik","position":{"start":{"line":76,"column":1,"offset":2898},"end":{"line":76,"column":72,"offset":2969},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"After installation you should have an IP attached to traefik service, look for it by executing the ","position":{"start":{"line":78,"column":1,"offset":2971},"end":{"line":78,"column":100,"offset":3070},"indent":[]}},{"type":"inlineCode","value":"get service","position":{"start":{"line":78,"column":100,"offset":3070},"end":{"line":78,"column":113,"offset":3083},"indent":[]}},{"type":"text","value":" command. You will see the ip address in the ","position":{"start":{"line":78,"column":113,"offset":3083},"end":{"line":78,"column":158,"offset":3128},"indent":[]}},{"type":"inlineCode","value":"EXTERNAL-IP","position":{"start":{"line":78,"column":158,"offset":3128},"end":{"line":78,"column":171,"offset":3141},"indent":[]}},{"type":"text","value":" attribute.","position":{"start":{"line":78,"column":171,"offset":3141},"end":{"line":78,"column":182,"offset":3152},"indent":[]}}],"position":{"start":{"line":78,"column":1,"offset":2971},"end":{"line":78,"column":182,"offset":3152},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"kubectl get svc\n\n    NAME                        TYPE           CLUSTER-IP     EXTERNAL-IP     PORT(S)                      AGE\n    kubernetes                  ClusterIP      10.0.0.1       <none>          443/TCP                      36h\n--> traefik                     LoadBalancer   10.0.27.93     40.114.168.96   443:31623/TCP,80:31804/TCP   35h\n    traefik-dashboard           NodePort       10.0.252.6     <none>          80:31146/TCP                 35h","position":{"start":{"line":80,"column":1,"offset":3154},"end":{"line":85,"column":115,"offset":3634},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Go to your DNS provider and link the domain you've configured in the first step ","position":{"start":{"line":87,"column":1,"offset":3636},"end":{"line":87,"column":81,"offset":3716},"indent":[]}},{"type":"inlineCode","value":"traefik.domain.com","position":{"start":{"line":87,"column":81,"offset":3716},"end":{"line":87,"column":101,"offset":3736},"indent":[]}},{"type":"text","value":" to the IP address of the ","position":{"start":{"line":87,"column":101,"offset":3736},"end":{"line":87,"column":127,"offset":3762},"indent":[]}},{"type":"inlineCode","value":"EXTERNAL-IP","position":{"start":{"line":87,"column":127,"offset":3762},"end":{"line":87,"column":140,"offset":3775},"indent":[]}},{"type":"text","value":" attribute.","position":{"start":{"line":87,"column":140,"offset":3775},"end":{"line":87,"column":151,"offset":3786},"indent":[]}}],"position":{"start":{"line":87,"column":1,"offset":3636},"end":{"line":87,"column":151,"offset":3786},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When browsing to ","position":{"start":{"line":89,"column":1,"offset":3788},"end":{"line":89,"column":18,"offset":3805},"indent":[]}},{"type":"inlineCode","value":"traefik.domain.com","position":{"start":{"line":89,"column":18,"offset":3805},"end":{"line":89,"column":38,"offset":3825},"indent":[]}},{"type":"text","value":", you should see the traefik dashboard showing up.","position":{"start":{"line":89,"column":38,"offset":3825},"end":{"line":89,"column":88,"offset":3875},"indent":[]}}],"position":{"start":{"line":89,"column":1,"offset":3788},"end":{"line":89,"column":88,"offset":3875},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"MongoDB","position":{"start":{"line":91,"column":4,"offset":3880},"end":{"line":91,"column":11,"offset":3887},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":3877},"end":{"line":91,"column":11,"offset":3887},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Kerberos Enterprise generates configurations for every surveillance camera that you want to monitor. These configuration files\nare stored centrally in a MongoDB database. Therefore we use Helm to install a MongoDB instance inside your cluster.","position":{"start":{"line":93,"column":1,"offset":3889},"end":{"line":94,"column":117,"offset":4132},"indent":[1]}}],"position":{"start":{"line":93,"column":1,"offset":3889},"end":{"line":94,"column":117,"offset":4132},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Have a look into the ","position":{"start":{"line":96,"column":1,"offset":4134},"end":{"line":96,"column":22,"offset":4155},"indent":[]}},{"type":"inlineCode","value":"mongodb/values.yaml","position":{"start":{"line":96,"column":22,"offset":4155},"end":{"line":96,"column":43,"offset":4176},"indent":[]}},{"type":"text","value":" file, you will find plenty of configurations for your mongodb instance. You will also find the attribute where you can change the root password of mongodb.","position":{"start":{"line":96,"column":43,"offset":4176},"end":{"line":96,"column":199,"offset":4332},"indent":[]}}],"position":{"start":{"line":96,"column":1,"offset":4134},"end":{"line":96,"column":199,"offset":4332},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"helm install --name mongodb stable/mongodb --values ./mongodb/values.yaml","position":{"start":{"line":98,"column":1,"offset":4334},"end":{"line":98,"column":78,"offset":4411},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Factory","position":{"start":{"line":101,"column":4,"offset":4417},"end":{"line":101,"column":11,"offset":4424},"indent":[]}}],"position":{"start":{"line":101,"column":1,"offset":4414},"end":{"line":101,"column":11,"offset":4424},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The last step is to install the factory service. Kerberos Enterprise is managed through an application which we call the ","position":{"start":{"line":103,"column":1,"offset":4426},"end":{"line":103,"column":122,"offset":4547},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Factory","position":{"start":{"line":103,"column":124,"offset":4549},"end":{"line":103,"column":131,"offset":4556},"indent":[]}}],"position":{"start":{"line":103,"column":122,"offset":4547},"end":{"line":103,"column":133,"offset":4558},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":103,"column":133,"offset":4558},"end":{"line":103,"column":134,"offset":4559},"indent":[]}}],"position":{"start":{"line":103,"column":1,"offset":4426},"end":{"line":103,"column":134,"offset":4559},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The Factory is responsible for initiating\nthe deployments inside your cluster. These deployments is what we also call (similar to the Open Source version) the machinery.","position":{"start":{"line":105,"column":1,"offset":4561},"end":{"line":106,"column":128,"offset":4730},"indent":[1]}}],"position":{"start":{"line":105,"column":1,"offset":4561},"end":{"line":106,"column":128,"offset":4730},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"The Factory comes as a web interface which provides you with a tool to update your machineries easily, monitor them, etc. The Factory is the central portal for managing Kerberos Enterprise inside your cluster.","position":{"start":{"line":108,"column":1,"offset":4732},"end":{"line":108,"column":210,"offset":4941},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":4732},"end":{"line":108,"column":210,"offset":4941},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before installing the Factory service, open the ","position":{"start":{"line":110,"column":1,"offset":4943},"end":{"line":110,"column":49,"offset":4991},"indent":[]}},{"type":"inlineCode","value":"factory/kubernetes.yaml","position":{"start":{"line":110,"column":49,"offset":4991},"end":{"line":110,"column":74,"offset":5016},"indent":[]}},{"type":"text","value":" configuration file. At the bottom file you will find two endpoints, similar to the traefik config file. Update the domain names to your own domain, and add these to your DNS server (pointing to the same IP as the traefik EXTERNAL-IP).","position":{"start":{"line":110,"column":74,"offset":5016},"end":{"line":110,"column":309,"offset":5251},"indent":[]}}],"position":{"start":{"line":110,"column":1,"offset":4943},"end":{"line":110,"column":309,"offset":5251},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"    spec:\n      rules:\n-->   - host: factory.domain.com\n        http:\n          paths:\n          - path: /\n            backend:\n              serviceName: factory\n              servicePort: 80\n-->   - host: api.factory.domain.com\n        http:\n          paths:\n          - path: /\n            backend:\n              serviceName: factory\n              servicePort: 8081","position":{"start":{"line":112,"column":1,"offset":5253},"end":{"line":127,"column":36,"offset":5685},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Once you have corrected the DNS names, install the Factory service inside your cluster.","position":{"start":{"line":129,"column":1,"offset":5687},"end":{"line":129,"column":88,"offset":5774},"indent":[]}}],"position":{"start":{"line":129,"column":1,"offset":5687},"end":{"line":129,"column":88,"offset":5774},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"kubectl apply -f ./factory/kubernetes.yaml","position":{"start":{"line":131,"column":1,"offset":5776},"end":{"line":131,"column":47,"offset":5822},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Test out configuration","position":{"start":{"line":134,"column":3,"offset":5827},"end":{"line":134,"column":25,"offset":5849},"indent":[]}}],"position":{"start":{"line":134,"column":1,"offset":5825},"end":{"line":134,"column":25,"offset":5849},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If everything worked out as expected, you should now have following services in your cluster:","position":{"start":{"line":136,"column":1,"offset":5851},"end":{"line":136,"column":94,"offset":5944},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":5851},"end":{"line":136,"column":94,"offset":5944},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"MongoDB","position":{"start":{"line":138,"column":5,"offset":5950},"end":{"line":138,"column":12,"offset":5957},"indent":[]}}],"position":{"start":{"line":138,"column":5,"offset":5950},"end":{"line":138,"column":12,"offset":5957},"indent":[]}}],"position":{"start":{"line":138,"column":1,"offset":5946},"end":{"line":138,"column":12,"offset":5957},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Traefik","position":{"start":{"line":139,"column":5,"offset":5962},"end":{"line":139,"column":12,"offset":5969},"indent":[]}}],"position":{"start":{"line":139,"column":5,"offset":5962},"end":{"line":139,"column":12,"offset":5969},"indent":[]}}],"position":{"start":{"line":139,"column":1,"offset":5958},"end":{"line":139,"column":12,"offset":5969},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Factory","position":{"start":{"line":140,"column":5,"offset":5974},"end":{"line":140,"column":12,"offset":5981},"indent":[]}}],"position":{"start":{"line":140,"column":5,"offset":5974},"end":{"line":140,"column":12,"offset":5981},"indent":[]}}],"position":{"start":{"line":140,"column":1,"offset":5970},"end":{"line":140,"column":12,"offset":5981},"indent":[]}}],"position":{"start":{"line":138,"column":1,"offset":5946},"end":{"line":140,"column":12,"offset":5981},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"It should look like this.","position":{"start":{"line":142,"column":1,"offset":5983},"end":{"line":142,"column":26,"offset":6008},"indent":[]}}],"position":{"start":{"line":142,"column":1,"offset":5983},"end":{"line":142,"column":26,"offset":6008},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"$ kubectl get pods\nNAME                              READY   STATUS    RESTARTS   AGE\nfactory-6f5c877d7c-hf77p          1/1     Running   0          2d11h\nmongodb-55566dc65c-xgmns          2/2     Running   0          4d13h\ntraefik-7d566ccc47-mwslb          1/1     Running   0          4d12h","position":{"start":{"line":144,"column":1,"offset":6010},"end":{"line":148,"column":73,"offset":6322},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Access the system","position":{"start":{"line":150,"column":4,"offset":6327},"end":{"line":150,"column":21,"offset":6344},"indent":[]}}],"position":{"start":{"line":150,"column":1,"offset":6324},"end":{"line":150,"column":21,"offset":6344},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once everything is configured correctly your cluster and DNS, you should be able to setup the Factory application. By navigating to the Factory domain ","position":{"start":{"line":152,"column":1,"offset":6346},"end":{"line":152,"column":152,"offset":6497},"indent":[]}},{"type":"inlineCode","value":"factory.domain.com","position":{"start":{"line":152,"column":152,"offset":6497},"end":{"line":152,"column":172,"offset":6517},"indent":[]}},{"type":"text","value":" in your browser you will see the Factory login page showing up.","position":{"start":{"line":152,"column":172,"offset":6517},"end":{"line":152,"column":236,"offset":6581},"indent":[]}}],"position":{"start":{"line":152,"column":1,"offset":6346},"end":{"line":152,"column":236,"offset":6581},"indent":[]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"../../public/images/factory/kerberos-factory-loginpage.png","alt":"Factory","position":{"start":{"line":154,"column":1,"offset":6583},"end":{"line":154,"column":71,"offset":6653},"indent":[]}}],"position":{"start":{"line":154,"column":1,"offset":6583},"end":{"line":154,"column":71,"offset":6653},"indent":[]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":157,"column":1,"offset":6656},"end":{"line":157,"column":31,"offset":6686},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":157,"column":31,"offset":6686}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/i353408/Vagrant/www/repos/documentation/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nimport ReplaceVersion from \"../components/ReplaceVersion\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h1 {...{\n      \"id\": \"introduction\"\n    }}>{`Introduction`}</h1>\n    <p>{`Start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (`}<strong parentName=\"p\">{`AWS`}</strong>{`, `}<strong parentName=\"p\">{`GCP`}</strong>{` or `}<strong parentName=\"p\">{`Azure`}</strong>{`),\ncloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`TODO write tutorial or create link to tutorial.`}</span></code></pre>\n    <h1 {...{\n      \"id\": \"installation\"\n    }}>{`Installation`}</h1>\n    <p>{`Before setting up Kerberos Enterprise, some configuration needs to happen. First thing that we need to do is setting up the RBAC permissions (Role Based Access Control). We need to enable this to be able to query specific endpoints from the Kubernetes API. By default these endpoints are locked, so we need to unlock them.`}</p>\n    <p>{`First clone the configrations from our Github repo.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`git clone https://github.com/kerberos-io/enterprise-factory`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`cd enterprise-factory`}</span></code></pre>\n    <p>{`Next go into the directory and execute the first Kubernetes configuration file `}<inlineCode parentName=\"p\">{`clusterrole.yaml`}</inlineCode>{`.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create -f ./clusterrole.yaml`}</span></code></pre>\n    <p>{`This will make several actions inside your cluster available. We need this to be able to create deployments from the factory web app.`}</p>\n    <h2 {...{\n      \"id\": \"helm\"\n    }}>{`Helm`}</h2>\n    <p>{`Next we will install a couple of dependencies which are required for Kerberos Enterprise. `}<a parentName=\"p\" {...{\n        \"href\": \"https://helm.sh/\"\n      }}><strong parentName=\"a\">{`Helm`}</strong></a>{` is a package manager for Kubernetes, it helps you setting up services more easily (this could be a MQTT broker, a database, etc).\nInstead of writing yaml files for every service we need, we use so called `}<strong parentName=\"p\">{`Charts`}</strong>{` (libraries), that you can reuse and configure the,\nwith the appropriate settings.`}</p>\n    <p>{`Use one of the preferred OS package managers to install the Helm client:`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`brew install helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`choco install kubernetes-helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`scoop install helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`gofish install helm`}</span></code></pre>\n    <h3 {...{\n      \"id\": \"initiate-helm\"\n    }}>{`Initiate helm`}</h3>\n    <p>{`When you've installed the Helm client, we need to use it to initiate Helm (also called the Tiller service) inside your cluster.\nTiller is what they call the server component of Helm.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create serviceaccount tiller --namespace kube-system`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create -f ./tiller-clusterrolebinding.yaml`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm init --service-account tiller`}</span></code></pre>\n    <p>{`Now you have installed `}<strong parentName=\"p\">{`Helm`}</strong>{` inside your cluster we can move on by installing the dependencies.`}</p>\n    <h2 {...{\n      \"id\": \"traefik\"\n    }}>{`Traefik`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://containo.us/traefik/\"\n      }}><strong parentName=\"a\">{`Traefik`}</strong></a>{` is a reverse proxy and load balancer which allows you to\nexpose your deployments more easily. Kerberos uses Traefik to expose it's APIs more easily.`}</p>\n    <p>{`By executing following helm command, we will install traefik and link it to a specific DNS name. Open the traefik values file, and update the DNS name to your own domain.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    dashboard:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`      enabled: true`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`-->   domain: traefik.domain.com`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`      serviceType: NodePort`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    rbac:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`        enabled: true`}</span></code></pre>\n    <p>{`Execute the `}<inlineCode parentName=\"p\">{`helm install`}</inlineCode>{` command.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm install --name traefik -f ./traefik/values.yaml stable/traefik`}</span></code></pre>\n    <p>{`After installation you should have an IP attached to traefik service, look for it by executing the `}<inlineCode parentName=\"p\">{`get service`}</inlineCode>{` command. You will see the ip address in the `}<inlineCode parentName=\"p\">{`EXTERNAL-IP`}</inlineCode>{` attribute.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl get svc`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    NAME                        TYPE           CLUSTER-IP     EXTERNAL-IP     PORT(S)                      AGE`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    kubernetes                  ClusterIP      10.0.0.1       <none>          443/TCP                      36h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`--> traefik                     LoadBalancer   10.0.27.93     40.114.168.96   443:31623/TCP,80:31804/TCP   35h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    traefik-dashboard           NodePort       10.0.252.6     <none>          80:31146/TCP                 35h`}</span></code></pre>\n    <p>{`Go to your DNS provider and link the domain you've configured in the first step `}<inlineCode parentName=\"p\">{`traefik.domain.com`}</inlineCode>{` to the IP address of the `}<inlineCode parentName=\"p\">{`EXTERNAL-IP`}</inlineCode>{` attribute.`}</p>\n    <p>{`When browsing to `}<inlineCode parentName=\"p\">{`traefik.domain.com`}</inlineCode>{`, you should see the traefik dashboard showing up.`}</p>\n    <h2 {...{\n      \"id\": \"mongodb\"\n    }}>{`MongoDB`}</h2>\n    <p>{`Kerberos Enterprise generates configurations for every surveillance camera that you want to monitor. These configuration files\nare stored centrally in a MongoDB database. Therefore we use Helm to install a MongoDB instance inside your cluster.`}</p>\n    <p>{`Have a look into the `}<inlineCode parentName=\"p\">{`mongodb/values.yaml`}</inlineCode>{` file, you will find plenty of configurations for your mongodb instance. You will also find the attribute where you can change the root password of mongodb.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm install --name mongodb stable/mongodb --values ./mongodb/values.yaml`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"factory\"\n    }}>{`Factory`}</h2>\n    <p>{`The last step is to install the factory service. Kerberos Enterprise is managed through an application which we call the `}<strong parentName=\"p\">{`Factory`}</strong>{`.`}</p>\n    <p>{`The Factory is responsible for initiating\nthe deployments inside your cluster. These deployments is what we also call (similar to the Open Source version) the machinery.`}</p>\n    <p>{`The Factory comes as a web interface which provides you with a tool to update your machineries easily, monitor them, etc. The Factory is the central portal for managing Kerberos Enterprise inside your cluster.`}</p>\n    <p>{`Before installing the Factory service, open the `}<inlineCode parentName=\"p\">{`factory/kubernetes.yaml`}</inlineCode>{` configuration file. At the bottom file you will find two endpoints, similar to the traefik config file. Update the domain names to your own domain, and add these to your DNS server (pointing to the same IP as the traefik EXTERNAL-IP).`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    spec:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`      rules:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`-->   - host: factory.domain.com`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`        http:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`          paths:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`          - path: /`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`            backend:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`              serviceName: factory`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`              servicePort: 80`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`-->   - host: api.factory.domain.com`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`        http:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`          paths:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`          - path: /`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`            backend:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`              serviceName: factory`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`              servicePort: 8081`}</span></code></pre>\n    <p>{`Once you have corrected the DNS names, install the Factory service inside your cluster.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl apply -f ./factory/kubernetes.yaml`}</span></code></pre>\n    <h1 {...{\n      \"id\": \"test-out-configuration\"\n    }}>{`Test out configuration`}</h1>\n    <p>{`If everything worked out as expected, you should now have following services in your cluster:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`MongoDB`}</li>\n      <li parentName=\"ul\">{`Traefik`}</li>\n      <li parentName=\"ul\">{`Factory`}</li>\n    </ul>\n    <p>{`It should look like this.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`$ kubectl get pods`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`NAME                              READY   STATUS    RESTARTS   AGE`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`factory-6f5c877d7c-hf77p          1/1     Running   0          2d11h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`mongodb-55566dc65c-xgmns          2/2     Running   0          4d13h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`traefik-7d566ccc47-mwslb          1/1     Running   0          4d12h`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"access-the-system\"\n    }}>{`Access the system`}</h2>\n    <p>{`Once everything is configured correctly your cluster and DNS, you should be able to setup the Factory application. By navigating to the Factory domain `}<inlineCode parentName=\"p\">{`factory.domain.com`}</inlineCode>{` in your browser you will see the Factory login page showing up.`}</p>\n    <p><img alt=\"Factory\" src={require(\"../../public/images/factory/kerberos-factory-loginpage.png\")} /></p>\n\n    <style {...{\n      \"className\": \"vscode-highlight-styles\"\n    }}>{`\n  :root {\n  --vscode-highlight-padding-v: 1rem;\n  --vscode-highlight-padding-h: 1.5rem;\n  --vscode-highlight-padding-top: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-right: var(--vscode-highlight-padding-h);\n  --vscode-highlight-padding-bottom: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-left: var(--vscode-highlight-padding-h);\n  --vscode-highlight-border-radius: 8px;\n\n  --vscode-highlight-line-highlighted-background-color: transparent;\n  --vscode-highlight-line-highlighted-border-width: 4px;\n  --vscode-highlight-line-highlighted-border-color: transparent;\n}\n\n.vscode-highlight {\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n  padding-top: 1rem;\n  padding-top: var(--vscode-highlight-padding-top);\n  padding-bottom: 1rem;\n  padding-bottom: var(--vscode-highlight-padding-bottom);\n  border-radius: 8px;\n  border-radius: var(--vscode-highlight-border-radius);\n  font-feature-settings: normal;\n}\n\n.vscode-highlight-code {\n  display: inline-block;\n  min-width: 100%;\n}\n\n.vscode-highlight-line {\n  display: inline-block;\n  box-sizing: border-box;\n  width: 100%;\n  padding-left: 1.5rem;\n  padding-left: var(--vscode-highlight-padding-left);\n  padding-right: 1.5rem;\n  padding-right: var(--vscode-highlight-padding-right);\n}\n\n.vscode-highlight-line-highlighted {\n  background-color: var(--vscode-highlight-line-highlighted-background-color);\n  box-shadow: inset var(--vscode-highlight-line-highlighted-border-width) 0 0 0 var(--vscode-highlight-line-highlighted-border-color);\n}\n\n  .default-dark {\nbackground-color: #1E1E1E;\ncolor: #D4D4D4;\n}\n`}</style>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}