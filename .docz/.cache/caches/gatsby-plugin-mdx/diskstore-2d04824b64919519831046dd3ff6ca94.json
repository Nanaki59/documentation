{"expireTime":9007200838837127000,"key":"gatsby-plugin-mdx-entire-payload-071ca29a1f93cfb9aed143d340bf4a65-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/i353408/Vagrant/www/repos/documentation/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":125,"offset":126},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":128},"end":{"line":5,"column":29,"offset":156},"indent":[]}},{"type":"import","value":"import ReplaceVersion from \"../components/ReplaceVersion\";","position":{"start":{"line":8,"column":1,"offset":159},"end":{"line":8,"column":59,"offset":217},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Introduction","position":{"start":{"line":10,"column":3,"offset":221},"end":{"line":10,"column":15,"offset":233},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":219},"end":{"line":10,"column":15,"offset":233},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (","position":{"start":{"line":12,"column":1,"offset":235},"end":{"line":12,"column":88,"offset":322},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"AWS","position":{"start":{"line":12,"column":90,"offset":324},"end":{"line":12,"column":93,"offset":327},"indent":[]}}],"position":{"start":{"line":12,"column":88,"offset":322},"end":{"line":12,"column":95,"offset":329},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":12,"column":95,"offset":329},"end":{"line":12,"column":97,"offset":331},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"GCP","position":{"start":{"line":12,"column":99,"offset":333},"end":{"line":12,"column":102,"offset":336},"indent":[]}}],"position":{"start":{"line":12,"column":97,"offset":331},"end":{"line":12,"column":104,"offset":338},"indent":[]}},{"type":"text","value":" or ","position":{"start":{"line":12,"column":104,"offset":338},"end":{"line":12,"column":108,"offset":342},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Azure","position":{"start":{"line":12,"column":110,"offset":344},"end":{"line":12,"column":115,"offset":349},"indent":[]}}],"position":{"start":{"line":12,"column":108,"offset":342},"end":{"line":12,"column":117,"offset":351},"indent":[]}},{"type":"text","value":"),\ncloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.","position":{"start":{"line":12,"column":117,"offset":351},"end":{"line":13,"column":90,"offset":443},"indent":[1]}}],"position":{"start":{"line":12,"column":1,"offset":235},"end":{"line":13,"column":90,"offset":443},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"TODO write tutorial or create link to tutorial.","position":{"start":{"line":15,"column":1,"offset":445},"end":{"line":15,"column":52,"offset":496},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Installation","position":{"start":{"line":17,"column":3,"offset":500},"end":{"line":17,"column":15,"offset":512},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":498},"end":{"line":17,"column":15,"offset":512},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Before setting up Kerberos Enterprise, some configuration needs to happen. First thing that needs to happen is setting up the RBAC permissions (Role Based Access Control),\nwe need to do this to query specific endpoints from the Kubernetes API. By default these endpoints are blocked, so we need\nto unblock them.","position":{"start":{"line":19,"column":1,"offset":514},"end":{"line":21,"column":17,"offset":825},"indent":[1,1]}}],"position":{"start":{"line":19,"column":1,"offset":514},"end":{"line":21,"column":17,"offset":825},"indent":[1,1]}},{"type":"code","lang":null,"meta":null,"value":"kubectl create -f ./clusterrole.yaml","position":{"start":{"line":23,"column":1,"offset":827},"end":{"line":23,"column":41,"offset":867},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"clusterrole.yaml","position":{"start":{"line":26,"column":1,"offset":870},"end":{"line":26,"column":17,"offset":886},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":870},"end":{"line":26,"column":17,"offset":886},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"kind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: pods-list\nrules:\n- apiGroups: [\"\", \"apps\"]\n  resources: [\"pods\", \"pods/log\", \"deployments\", \"services\", \"endpoints\", \"nodes\"]\n  verbs: [\"get\", \"list\", \"create\", \"delete\"]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: pods-list\nsubjects:\n- kind: ServiceAccount\n  name: default\n  namespace: default\nroleRef:\n  kind: ClusterRole\n  name: pods-list\n  apiGroup: rbac.authorization.k8s.io","position":{"start":{"line":28,"column":1,"offset":888},"end":{"line":48,"column":42,"offset":1472},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Helm","position":{"start":{"line":51,"column":4,"offset":1478},"end":{"line":51,"column":8,"offset":1482},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":1475},"end":{"line":51,"column":8,"offset":1482},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://helm.sh/","children":[{"type":"strong","children":[{"type":"text","value":"Helm","position":{"start":{"line":53,"column":4,"offset":1487},"end":{"line":53,"column":8,"offset":1491},"indent":[]}}],"position":{"start":{"line":53,"column":2,"offset":1485},"end":{"line":53,"column":10,"offset":1493},"indent":[]}}],"position":{"start":{"line":53,"column":1,"offset":1484},"end":{"line":53,"column":29,"offset":1512},"indent":[]}},{"type":"text","value":" is a package manager for Kubernetes, it helps you setting up services more easily (this could be a MQTT broker, a database, etc).\nInstead of writing yaml files for every service we need, we use so called ","position":{"start":{"line":53,"column":29,"offset":1512},"end":{"line":54,"column":75,"offset":1717},"indent":[1]}},{"type":"strong","children":[{"type":"text","value":"Charts","position":{"start":{"line":54,"column":77,"offset":1719},"end":{"line":54,"column":83,"offset":1725},"indent":[]}}],"position":{"start":{"line":54,"column":75,"offset":1717},"end":{"line":54,"column":85,"offset":1727},"indent":[]}},{"type":"text","value":" (libraries), that you can reuse and configure the,\nwith the appropriate settings.","position":{"start":{"line":54,"column":85,"offset":1727},"end":{"line":55,"column":31,"offset":1809},"indent":[1]}}],"position":{"start":{"line":53,"column":1,"offset":1484},"end":{"line":55,"column":31,"offset":1809},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Use one of the preferred OS package managers to install the Helm client:","position":{"start":{"line":57,"column":1,"offset":1811},"end":{"line":57,"column":73,"offset":1883},"indent":[]}}],"position":{"start":{"line":57,"column":1,"offset":1811},"end":{"line":57,"column":73,"offset":1883},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"brew install helm\n\nchoco install kubernetes-helm\n\nscoop install helm\n\ngofish install helm","position":{"start":{"line":59,"column":1,"offset":1885},"end":{"line":65,"column":24,"offset":1990},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Initiate helm","position":{"start":{"line":67,"column":5,"offset":1996},"end":{"line":67,"column":18,"offset":2009},"indent":[]}}],"position":{"start":{"line":67,"column":1,"offset":1992},"end":{"line":67,"column":18,"offset":2009},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When you've installed the Helm client, we need to use it to initiate Helm (also called the Tiller service) inside your cluster.\nTiller is what they call the server component of Helm.","position":{"start":{"line":69,"column":1,"offset":2011},"end":{"line":70,"column":55,"offset":2193},"indent":[1]}}],"position":{"start":{"line":69,"column":1,"offset":2011},"end":{"line":70,"column":55,"offset":2193},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"kubectl create serviceaccount tiller --namespace kube-system\nkubectl create -f ./tiller-clusterrolebinding.yaml\nhelm init --service-account tiller","position":{"start":{"line":72,"column":1,"offset":2195},"end":{"line":74,"column":39,"offset":2353},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"tiller-clusterrolebinding.yaml","position":{"start":{"line":76,"column":1,"offset":2355},"end":{"line":76,"column":31,"offset":2385},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":2355},"end":{"line":76,"column":31,"offset":2385},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"kind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1beta1\nmetadata:\n  name: tiller-clusterrolebinding\nsubjects:\n- kind: ServiceAccount\n  name: tiller\n  namespace: kube-system\nroleRef:\n  kind: ClusterRole\n  name: cluster-admin\n  apiGroup: \"\"","position":{"start":{"line":78,"column":1,"offset":2387},"end":{"line":89,"column":19,"offset":2688},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Traefik","position":{"start":{"line":91,"column":4,"offset":2693},"end":{"line":91,"column":11,"offset":2700},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":2690},"end":{"line":91,"column":11,"offset":2700},"indent":[]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://containo.us/traefik/","children":[{"type":"strong","children":[{"type":"text","value":"Traefik","position":{"start":{"line":93,"column":4,"offset":2705},"end":{"line":93,"column":11,"offset":2712},"indent":[]}}],"position":{"start":{"line":93,"column":2,"offset":2703},"end":{"line":93,"column":13,"offset":2714},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":2702},"end":{"line":93,"column":44,"offset":2745},"indent":[]}},{"type":"text","value":" is a reverse proxy and load balancer which allows you to\nexpose your deployments more easily. Kerberos uses Traefik to expose it's APIs more easily. More info will follow.","position":{"start":{"line":93,"column":44,"offset":2745},"end":{"line":94,"column":115,"offset":2917},"indent":[1]}}],"position":{"start":{"line":93,"column":1,"offset":2702},"end":{"line":94,"column":115,"offset":2917},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"helm install --name traefik -f ./traefik/values.yaml stable/traefik","position":{"start":{"line":96,"column":1,"offset":2919},"end":{"line":96,"column":72,"offset":2990},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"./traefik/values.yaml","position":{"start":{"line":98,"column":1,"offset":2992},"end":{"line":98,"column":22,"offset":3013},"indent":[]}}],"position":{"start":{"line":98,"column":1,"offset":2992},"end":{"line":98,"column":22,"offset":3013},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"dashboard:\n  enabled: true\n  domain: your.domain.com\n  serviceType: NodePort\nrbac:\n    enabled: true","position":{"start":{"line":100,"column":1,"offset":3015},"end":{"line":105,"column":22,"offset":3139},"indent":[1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"MongoDB","position":{"start":{"line":107,"column":4,"offset":3144},"end":{"line":107,"column":11,"offset":3151},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":3141},"end":{"line":107,"column":11,"offset":3151},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Kerberos Enterprise generates configurations for every surveillance camera that you want to monitor. These configuration files\nare stored centrally in a MongoDB database. Therefore we use Helm to install a MongoDB instance inside your cluster.","position":{"start":{"line":109,"column":1,"offset":3153},"end":{"line":110,"column":117,"offset":3396},"indent":[1]}}],"position":{"start":{"line":109,"column":1,"offset":3153},"end":{"line":110,"column":117,"offset":3396},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"helm install --name mongodb stable/mongodb --values ./mongodb/values.yaml","position":{"start":{"line":112,"column":1,"offset":3398},"end":{"line":112,"column":78,"offset":3475},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":" ./mongodb/values.yaml","position":{"start":{"line":114,"column":1,"offset":3477},"end":{"line":114,"column":23,"offset":3499},"indent":[]}}],"position":{"start":{"line":114,"column":1,"offset":3477},"end":{"line":114,"column":23,"offset":3499},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"...","position":{"start":{"line":116,"column":1,"offset":3501},"end":{"line":116,"column":8,"offset":3508},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Factory","position":{"start":{"line":118,"column":4,"offset":3513},"end":{"line":118,"column":11,"offset":3520},"indent":[]}}],"position":{"start":{"line":118,"column":1,"offset":3510},"end":{"line":118,"column":11,"offset":3520},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Kerberos Enterprise is managed through ann application which we call the ","position":{"start":{"line":120,"column":1,"offset":3522},"end":{"line":120,"column":74,"offset":3595},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"Factory","position":{"start":{"line":120,"column":76,"offset":3597},"end":{"line":120,"column":83,"offset":3604},"indent":[]}}],"position":{"start":{"line":120,"column":74,"offset":3595},"end":{"line":120,"column":85,"offset":3606},"indent":[]}},{"type":"text","value":". The Factory is responsible for initiating\nthe deployments inside your cluster. These deployments is what we also call (similar to the Open Source version) the machinery.\nThe Factory also provide you with the tools to update your machineries easily through a web interface, monitor them, etc. The factory\nis the central portal for managing Kerberos Enterprise inside your cluster.","position":{"start":{"line":120,"column":85,"offset":3606},"end":{"line":123,"column":76,"offset":3987},"indent":[1,1,1]}}],"position":{"start":{"line":120,"column":1,"offset":3522},"end":{"line":123,"column":76,"offset":3987},"indent":[1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"kubectl apply -f ./factory/kubernetes.yaml","position":{"start":{"line":125,"column":1,"offset":3989},"end":{"line":125,"column":47,"offset":4035},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"./factory/kubernetes.yaml","position":{"start":{"line":127,"column":1,"offset":4037},"end":{"line":127,"column":26,"offset":4062},"indent":[]}}],"position":{"start":{"line":127,"column":1,"offset":4037},"end":{"line":127,"column":26,"offset":4062},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"... link to yaml ...","position":{"start":{"line":129,"column":1,"offset":4064},"end":{"line":129,"column":25,"offset":4088},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Test out configuration","position":{"start":{"line":131,"column":3,"offset":4092},"end":{"line":131,"column":25,"offset":4114},"indent":[]}}],"position":{"start":{"line":131,"column":1,"offset":4090},"end":{"line":131,"column":25,"offset":4114},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If everything worked out as expected, you should now have following services in your cluster:","position":{"start":{"line":133,"column":1,"offset":4116},"end":{"line":133,"column":94,"offset":4209},"indent":[]}}],"position":{"start":{"line":133,"column":1,"offset":4116},"end":{"line":133,"column":94,"offset":4209},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"MongoDB","position":{"start":{"line":135,"column":5,"offset":4215},"end":{"line":135,"column":12,"offset":4222},"indent":[]}}],"position":{"start":{"line":135,"column":5,"offset":4215},"end":{"line":135,"column":12,"offset":4222},"indent":[]}}],"position":{"start":{"line":135,"column":1,"offset":4211},"end":{"line":135,"column":12,"offset":4222},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Traefik","position":{"start":{"line":136,"column":5,"offset":4227},"end":{"line":136,"column":12,"offset":4234},"indent":[]}}],"position":{"start":{"line":136,"column":5,"offset":4227},"end":{"line":136,"column":12,"offset":4234},"indent":[]}}],"position":{"start":{"line":136,"column":1,"offset":4223},"end":{"line":136,"column":12,"offset":4234},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Factory","position":{"start":{"line":137,"column":5,"offset":4239},"end":{"line":137,"column":12,"offset":4246},"indent":[]}}],"position":{"start":{"line":137,"column":5,"offset":4239},"end":{"line":137,"column":12,"offset":4246},"indent":[]}}],"position":{"start":{"line":137,"column":1,"offset":4235},"end":{"line":137,"column":12,"offset":4246},"indent":[]}}],"position":{"start":{"line":135,"column":1,"offset":4211},"end":{"line":137,"column":12,"offset":4246},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"It should look like this.","position":{"start":{"line":139,"column":1,"offset":4248},"end":{"line":139,"column":26,"offset":4273},"indent":[]}}],"position":{"start":{"line":139,"column":1,"offset":4248},"end":{"line":139,"column":26,"offset":4273},"indent":[]}},{"type":"code","lang":null,"meta":null,"value":"$ kubectl get pods\nNAME                              READY   STATUS    RESTARTS   AGE\nfactory-6f5c877d7c-hf77p          1/1     Running   0          2d11h\nmongodb-55566dc65c-xgmns          2/2     Running   0          4d13h\ntraefik-7d566ccc47-mwslb          1/1     Running   0          4d12h","position":{"start":{"line":141,"column":1,"offset":4275},"end":{"line":145,"column":73,"offset":4587},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"DNS configuration","position":{"start":{"line":147,"column":4,"offset":4592},"end":{"line":147,"column":21,"offset":4609},"indent":[]}}],"position":{"start":{"line":147,"column":1,"offset":4589},"end":{"line":147,"column":21,"offset":4609},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"When deploying both Traefik and Factory you had to specify a domain. In this step we need to configure your DNS server. Look for the\nTraefik service, and copy its External IP.","position":{"start":{"line":149,"column":1,"offset":4611},"end":{"line":150,"column":43,"offset":4786},"indent":[1]}}],"position":{"start":{"line":149,"column":1,"offset":4611},"end":{"line":150,"column":43,"offset":4786},"indent":[1]}},{"type":"code","lang":null,"meta":null,"value":"    $ kubectl get svc\n    NAME                 TYPE           CLUSTER-IP    EXTERNAL-IP     PORT(S)                      AGE\n    factory              ClusterIP      10.0.10.175   <none>          80/TCP,8081/TCP              4d13h\n    kubernetes           ClusterIP      10.0.0.1      <none>          443/TCP                      4d15h\n    mongodb              ClusterIP      10.0.1.0      <none>          27017/TCP,9216/TCP           4d14h\n--> traefik              LoadBalancer   10.0.10.97    34.66.138.141   443:31683/TCP,80:32053/TCP   4d14h\n    traefik-dashboard    NodePort       10.0.14.209   <none>          80:32044/TCP                 4d14h","position":{"start":{"line":152,"column":1,"offset":4788},"end":{"line":158,"column":109,"offset":5465},"indent":[1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Add this External IP to your DNS server, so it will resolve your domains:","position":{"start":{"line":160,"column":1,"offset":5467},"end":{"line":160,"column":74,"offset":5540},"indent":[]}}],"position":{"start":{"line":160,"column":1,"offset":5467},"end":{"line":160,"column":74,"offset":5540},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"traefik.domain.com (change to your domain)","position":{"start":{"line":162,"column":5,"offset":5546},"end":{"line":162,"column":47,"offset":5588},"indent":[]}}],"position":{"start":{"line":162,"column":5,"offset":5546},"end":{"line":162,"column":47,"offset":5588},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":5542},"end":{"line":162,"column":47,"offset":5588},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"factory.domain.com (change to your domain).","position":{"start":{"line":163,"column":5,"offset":5593},"end":{"line":163,"column":48,"offset":5636},"indent":[]}}],"position":{"start":{"line":163,"column":5,"offset":5593},"end":{"line":163,"column":48,"offset":5636},"indent":[]}}],"position":{"start":{"line":163,"column":1,"offset":5589},"end":{"line":163,"column":48,"offset":5636},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"api.factory.domain.com (change to your domain).","position":{"start":{"line":164,"column":5,"offset":5641},"end":{"line":164,"column":52,"offset":5688},"indent":[]}}],"position":{"start":{"line":164,"column":5,"offset":5641},"end":{"line":164,"column":52,"offset":5688},"indent":[]}}],"position":{"start":{"line":164,"column":1,"offset":5637},"end":{"line":164,"column":52,"offset":5688},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":5542},"end":{"line":164,"column":52,"offset":5688},"indent":[1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Access the system","position":{"start":{"line":166,"column":4,"offset":5693},"end":{"line":166,"column":21,"offset":5710},"indent":[]}}],"position":{"start":{"line":166,"column":1,"offset":5690},"end":{"line":166,"column":21,"offset":5710},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once everything is configured correctly your cluster and dns, you should be able to setup the Factory application. By navigating\nto the Factory domain in your browser you will see the Factory web page showing up.","position":{"start":{"line":168,"column":1,"offset":5712},"end":{"line":169,"column":84,"offset":5924},"indent":[1]}}],"position":{"start":{"line":168,"column":1,"offset":5712},"end":{"line":169,"column":84,"offset":5924},"indent":[1]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":172,"column":1,"offset":5927},"end":{"line":172,"column":31,"offset":5957},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":172,"column":31,"offset":5957}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/i353408/Vagrant/www/repos/documentation/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nimport ReplaceVersion from \"../components/ReplaceVersion\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n\n    <h1 {...{\n      \"id\": \"introduction\"\n    }}>{`Introduction`}</h1>\n    <p>{`Start by installing a Kubernetes cluster. This can be done on one of the hyperscalers (`}<strong parentName=\"p\">{`AWS`}</strong>{`, `}<strong parentName=\"p\">{`GCP`}</strong>{` or `}<strong parentName=\"p\">{`Azure`}</strong>{`),\ncloud providers (Digital Ocean, Scaleway, etc) or on-premise in your own private network.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`TODO write tutorial or create link to tutorial.`}</span></code></pre>\n    <h1 {...{\n      \"id\": \"installation\"\n    }}>{`Installation`}</h1>\n    <p>{`Before setting up Kerberos Enterprise, some configuration needs to happen. First thing that needs to happen is setting up the RBAC permissions (Role Based Access Control),\nwe need to do this to query specific endpoints from the Kubernetes API. By default these endpoints are blocked, so we need\nto unblock them.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create -f ./clusterrole.yaml`}</span></code></pre>\n    <p>{`clusterrole.yaml`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kind: ClusterRole`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`apiVersion: rbac.authorization.k8s.io/v1`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`metadata:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: pods-list`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`rules:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`- apiGroups: [\"\", \"apps\"]`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  resources: [\"pods\", \"pods/log\", \"deployments\", \"services\", \"endpoints\", \"nodes\"]`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  verbs: [\"get\", \"list\", \"create\", \"delete\"]`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`---`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kind: ClusterRoleBinding`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`apiVersion: rbac.authorization.k8s.io/v1`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`metadata:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: pods-list`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`subjects:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`- kind: ServiceAccount`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: default`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  namespace: default`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`roleRef:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  kind: ClusterRole`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: pods-list`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  apiGroup: rbac.authorization.k8s.io`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"helm\"\n    }}>{`Helm`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://helm.sh/\"\n      }}><strong parentName=\"a\">{`Helm`}</strong></a>{` is a package manager for Kubernetes, it helps you setting up services more easily (this could be a MQTT broker, a database, etc).\nInstead of writing yaml files for every service we need, we use so called `}<strong parentName=\"p\">{`Charts`}</strong>{` (libraries), that you can reuse and configure the,\nwith the appropriate settings.`}</p>\n    <p>{`Use one of the preferred OS package managers to install the Helm client:`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`brew install helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`choco install kubernetes-helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`scoop install helm`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}></span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`gofish install helm`}</span></code></pre>\n    <h3 {...{\n      \"id\": \"initiate-helm\"\n    }}>{`Initiate helm`}</h3>\n    <p>{`When you've installed the Helm client, we need to use it to initiate Helm (also called the Tiller service) inside your cluster.\nTiller is what they call the server component of Helm.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create serviceaccount tiller --namespace kube-system`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl create -f ./tiller-clusterrolebinding.yaml`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm init --service-account tiller`}</span></code></pre>\n    <p>{`tiller-clusterrolebinding.yaml`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kind: ClusterRoleBinding`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`apiVersion: rbac.authorization.k8s.io/v1beta1`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`metadata:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: tiller-clusterrolebinding`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`subjects:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`- kind: ServiceAccount`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: tiller`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  namespace: kube-system`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`roleRef:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  kind: ClusterRole`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  name: cluster-admin`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  apiGroup: \"\"`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"traefik\"\n    }}>{`Traefik`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://containo.us/traefik/\"\n      }}><strong parentName=\"a\">{`Traefik`}</strong></a>{` is a reverse proxy and load balancer which allows you to\nexpose your deployments more easily. Kerberos uses Traefik to expose it's APIs more easily. More info will follow.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm install --name traefik -f ./traefik/values.yaml stable/traefik`}</span></code></pre>\n    <p>{`./traefik/values.yaml`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`dashboard:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  enabled: true`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  domain: your.domain.com`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`  serviceType: NodePort`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`rbac:`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    enabled: true`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"mongodb\"\n    }}>{`MongoDB`}</h2>\n    <p>{`Kerberos Enterprise generates configurations for every surveillance camera that you want to monitor. These configuration files\nare stored centrally in a MongoDB database. Therefore we use Helm to install a MongoDB instance inside your cluster.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`helm install --name mongodb stable/mongodb --values ./mongodb/values.yaml`}</span></code></pre>\n    <p>{` ./mongodb/values.yaml`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`...`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"factory\"\n    }}>{`Factory`}</h2>\n    <p>{`Kerberos Enterprise is managed through ann application which we call the `}<strong parentName=\"p\">{`Factory`}</strong>{`. The Factory is responsible for initiating\nthe deployments inside your cluster. These deployments is what we also call (similar to the Open Source version) the machinery.\nThe Factory also provide you with the tools to update your machineries easily through a web interface, monitor them, etc. The factory\nis the central portal for managing Kerberos Enterprise inside your cluster.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`kubectl apply -f ./factory/kubernetes.yaml`}</span></code></pre>\n    <p>{`./factory/kubernetes.yaml`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`... link to yaml ...`}</span></code></pre>\n    <h1 {...{\n      \"id\": \"test-out-configuration\"\n    }}>{`Test out configuration`}</h1>\n    <p>{`If everything worked out as expected, you should now have following services in your cluster:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`MongoDB`}</li>\n      <li parentName=\"ul\">{`Traefik`}</li>\n      <li parentName=\"ul\">{`Factory`}</li>\n    </ul>\n    <p>{`It should look like this.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`$ kubectl get pods`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`NAME                              READY   STATUS    RESTARTS   AGE`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`factory-6f5c877d7c-hf77p          1/1     Running   0          2d11h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`mongodb-55566dc65c-xgmns          2/2     Running   0          4d13h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`traefik-7d566ccc47-mwslb          1/1     Running   0          4d12h`}</span></code></pre>\n    <h2 {...{\n      \"id\": \"dns-configuration\"\n    }}>{`DNS configuration`}</h2>\n    <p>{`When deploying both Traefik and Factory you had to specify a domain. In this step we need to configure your DNS server. Look for the\nTraefik service, and copy its External IP.`}</p>\n    <pre {...{\n      \"className\": \"default-dark vscode-highlight\",\n      \"data-language\": \"\"\n    }}><code parentName=\"pre\" {...{\n        \"className\": \"vscode-highlight-code\"\n      }}><span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    $ kubectl get svc`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    NAME                 TYPE           CLUSTER-IP    EXTERNAL-IP     PORT(S)                      AGE`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    factory              ClusterIP      10.0.10.175   <none>          80/TCP,8081/TCP              4d13h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    kubernetes           ClusterIP      10.0.0.1      <none>          443/TCP                      4d15h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    mongodb              ClusterIP      10.0.1.0      <none>          27017/TCP,9216/TCP           4d14h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`--> traefik              LoadBalancer   10.0.10.97    34.66.138.141   443:31683/TCP,80:32053/TCP   4d14h`}</span>{`\n`}<span parentName=\"code\" {...{\n          \"className\": \"vscode-highlight-line\"\n        }}>{`    traefik-dashboard    NodePort       10.0.14.209   <none>          80:32044/TCP                 4d14h`}</span></code></pre>\n    <p>{`Add this External IP to your DNS server, so it will resolve your domains:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`traefik.domain.com (change to your domain)`}</li>\n      <li parentName=\"ul\">{`factory.domain.com (change to your domain).`}</li>\n      <li parentName=\"ul\">{`api.factory.domain.com (change to your domain).`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"access-the-system\"\n    }}>{`Access the system`}</h2>\n    <p>{`Once everything is configured correctly your cluster and dns, you should be able to setup the Factory application. By navigating\nto the Factory domain in your browser you will see the Factory web page showing up.`}</p>\n\n    <style {...{\n      \"className\": \"vscode-highlight-styles\"\n    }}>{`\n  :root {\n  --vscode-highlight-padding-v: 1rem;\n  --vscode-highlight-padding-h: 1.5rem;\n  --vscode-highlight-padding-top: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-right: var(--vscode-highlight-padding-h);\n  --vscode-highlight-padding-bottom: var(--vscode-highlight-padding-v);\n  --vscode-highlight-padding-left: var(--vscode-highlight-padding-h);\n  --vscode-highlight-border-radius: 8px;\n\n  --vscode-highlight-line-highlighted-background-color: transparent;\n  --vscode-highlight-line-highlighted-border-width: 4px;\n  --vscode-highlight-line-highlighted-border-color: transparent;\n}\n\n.vscode-highlight {\n  overflow: auto;\n  -webkit-overflow-scrolling: touch;\n  padding-top: 1rem;\n  padding-top: var(--vscode-highlight-padding-top);\n  padding-bottom: 1rem;\n  padding-bottom: var(--vscode-highlight-padding-bottom);\n  border-radius: 8px;\n  border-radius: var(--vscode-highlight-border-radius);\n  font-feature-settings: normal;\n}\n\n.vscode-highlight-code {\n  display: inline-block;\n  min-width: 100%;\n}\n\n.vscode-highlight-line {\n  display: inline-block;\n  box-sizing: border-box;\n  width: 100%;\n  padding-left: 1.5rem;\n  padding-left: var(--vscode-highlight-padding-left);\n  padding-right: 1.5rem;\n  padding-right: var(--vscode-highlight-padding-right);\n}\n\n.vscode-highlight-line-highlighted {\n  background-color: var(--vscode-highlight-line-highlighted-background-color);\n  box-shadow: inset var(--vscode-highlight-line-highlighted-border-width) 0 0 0 var(--vscode-highlight-line-highlighted-border-color);\n}\n\n  .default-dark {\nbackground-color: #1E1E1E;\ncolor: #D4D4D4;\n}\n`}</style>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}